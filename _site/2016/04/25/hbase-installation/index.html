<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="description" content="Where Duygu Serbest writes about her struggles, things she learnt and any other stuff related to programming, Data Mining, Machine Learning.">
  <meta name="keywords" content="duygu,serbest">

  <title>
    
      Installing HBase on a Distributed Hadoop Cluster &middot; Duygu Serbest
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
  <link rel="stylesheet" href="/assets/css/custom.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Where Duygu Serbest writes about her struggles, things she learnt and any other stuff related to programming, Data Mining, Machine Learning.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/tags/">Tags</a>
        
      
    

    <a class="sidebar-nav-item" href="https://www.linkedin.com/in/duyguserbest" target="_blank">Linkedin</a>
    <a class="sidebar-nav-item" href="https://github.com/duyguserbest" target="_blank">GitHub</a>
    <a class="sidebar-nav-item" href="https://twitter.com/serbestduygu" target="_blank">Twitter</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2016. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Duygu Serbest</a>
            <small>Codefolio of a coder.</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <ul class="tags">
  
    <li><a href="/tags/#hbase" class="tag">hbase</a></li>
  
    <li><a href="/tags/#installation" class="tag">installation</a></li>
  
</ul>

<div class="post">
  <h1 class="post-title">Installing HBase on a Distributed Hadoop Cluster</h1>
  <span class="post-date">25 Apr 2016</span>
  <p>Installation guide for distributed HBase with Zookeeper(which is a requirement for HBase, is being managed by HBase itself.).</p>

<h2 id="prerequisites">Prerequisites:</h2>
<p>Hadoop must be installed successfully.</p>

<h2 id="installation">Installation:</h2>
<p>Do everything listed below for every instance which is a node on hdfs network, you want to run HBase on.</p>

<ol>
  <li>Create a directory and navigate to created directory.
..* mkdir hbase</li>
  <li>Change folder’s owner if needed: 
..* sudo chown -R hadoop:hadoop hbase/
..* cd hbase</li>
  <li>Download hbase-0.94.12 to current directory.
..* wget “https://archive.apache.org/dist/hbase/hbase-0.94.12/hbase-0.94.12.tar.gz”</li>
  <li>Extract hbase files to current directory.
..* tar -xvzf hbase-0.94.12.tar.gz</li>
  <li>Navigate to extracted directory.
..* cd hbase-0.94.12/conf</li>
  <li>Edit hbase-site.xml using vim.
..* vim hbase-site.xml</li>
  <li>Set proper values to configuration properties.</li>
</ol>

<p>’’’</p>
<configuration>
...
  <property>
    <name>hbase.rootdir</name>
    <value>hdfs://{hdfs.namenode.address}:{hdfs.port}/hbase</value>
    <description>The directory shared by RegionServers.
    </description>
  </property>

  <property>
    <name>hbase.tmp.dir</name>
    <value>/work/hbase/tmp</value>
  </property>

  <property>
    <name>hbase.cluster.distributed</name>
    <value>true</value>
    <description>The mode the cluster will be in. Possible values are
      false: standalone and pseudo-distributed setups with managed Zookeeper
      true: fully-distributed with unmanaged Zookeeper Quorum (see hbase-env.sh)
    </description>
  </property>

    <property>
      <name>hbase.zookeeper.quorum</name>
     <value>{zookeeper.quorum.address}</value>
      <description>Comma separated list of servers in the ZooKeeper Quorum.
      For example, "host1.mydomain.com,host2.mydomain.com,host3.mydomain.com".
      By default this is set to localhost for local and pseudo-distributed modes
      of operation. For a fully-distributed setup, this should be set to a full
      list of ZooKeeper quorum servers. If HBASE_MANAGES_ZK is set in hbase-env.sh
      this is the list of servers which we will start/stop ZooKeeper on.
      </description>
    </property>
    <property>
      <name>hbase.zookeeper.property.dataDir</name>
      <value>/opt/zookeeper/zk-data</value>
      <description>Property from ZooKeeper's config zoo.cfg.
      The directory where the snapshot is stored.
      </description>
    </property>
...
</configuration>
<p>’’’</p>

<ol>
  <li>Edit regionservers file and list all hosts that you would have running Zookeeper.
..* vim regionservers
..* server30
server31
server32
server33</li>
  <li>
    <p>Add HBASE_HOME environment variable to bashrc.
..* vim ~/.bashrc
..* export HBASE_HOME=/opt/hbase/hbase-0.94.12
..* export PATH=$PATH:$HADOOP_HOME/bin:$HBASE_HOME/bin:$JAVA_HOME/bin
..* To test if variable is added successfully
..1. Logout from user session: 
..<em>exit
..2. Log back in:
..</em> sudo su - hadoop
..3. Echo environment variable:
..* echo $HBASE_HOME</p>
  </li>
  <li>Edit hbase-env.sh, uncomment and set proper values to properties.
..* export JAVA_HOME=/usr/lib/jvm/java-8-oracle
..* export HBASE_HEAPSIZE=4096
..* export HBASE_MANAGES_ZK=true</li>
  <li>Symlink hdfs-site.xml under ${HBASE_HOME}/conf.
..* ln -sv /opt/hadoop/hadoop-1.0.4/conf/hdfs-site.xml hdfs-site.xml</li>
  <li>Create HBase temp directory and Zookeeper data directory
..* cd /work
..* mkdir hbase
..* mkdir zookeeper
..* cd hbase
..* mkdir tmp
..* cd /work/zookeeper
..* mkdir zk-data</li>
</ol>

<h2 id="starting-hbase">Starting HBase:</h2>

<p>To start HBase run “./bin/start-hbase.sh” on “/opt/hbase/hbase-0.94.12” directory. The instance you have run the starter script becomes the master of the network. You must start Hadoop’s DFS and Map-Red frameworks before running this command.</p>

<h2 id="testing-installation">Testing Installation:</h2>

<h3 id="checking-if-hbase-initialised-successfully">Checking if HBase initialised successfully:</h3>

<p>Run “jps” on terminal and check if “HQuorumPeer” and “HRegionServer” processes running for every instance in your HBase network. When you run “jps” command on master you should also see the master process named “HMaster”.</p>

<h3 id="running-hbase-check">Running hbase check:</h3>

<p>When you run “hbase hbck”, there must be no inconsistencies detected. If an inconsistency has been detected, run “hbase hbck -repair” and/or “hbase hbck -fix” for easy fix.</p>

<h3 id="checking-hbase-shell">Checking HBase Shell:</h3>

<p>If HBase initialised successfully, you should be able to run “hbase shell” command to access tables. After running “hbase shell” if you come across 
java.lang.RuntimeException: java.lang.UnsatisfiedLinkError: /tmp/jffi3876542469706275102.tmp: /tmp/jffi3876542469706275102.tmp: failed to map segment from shared object: Operation not permitted</p>

<p>this exception then this means you can “not execute” on your /tmp directory.  This can mean that your company security policy block execution on tmp directory. To solve this problem you have two options: first one is giving execution permission on tmp to users, or changing java tmp directory by setting a parameter. 
To solve the problem by changing java tmp directory:
1. Create a new directory where the user you started HBase with has execution permission.
2. Add -Djava.io.tmpdir parameter to HBASE_OPTS environment variable on hbase-env.sh.
3. export HBASE_OPTS=”-Djava.io.tmpdir=/work/hbase/hbase-java-temp -XX:+UseConcMarkSweepGC”
4. Restart HBase.</p>

<h3 id="stopping-hbase">Stopping HBase:</h3>

<p>Run “./bin/stop-hbase.sh” on “/opt/hbase/hbase-0.94.12” directory.</p>


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2016/04/25/hello-world/">
            Hello World!
            <small>25 Apr 2016</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
